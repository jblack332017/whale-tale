---
title: "Whale_tale_charts"
author: "Josh Black"
date: "4/3/2018"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(knitr)
library(grid)
library(gridExtra)
library(GetoptLong)
library(xtable)
library(knitr)
library(reshape2)
library(grid)
library(scales)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
setwd("~/Projects/whale-tale")
inputData <- read.csv(file="input/train.csv", header=TRUE, sep=",")
input_counts <- inputData %>% plyr::count("Id")
input_freq <- table(input_counts$freq)
input_freq <- as.data.frame(input_freq)
distinct_classes = inputData %>% distinct(Id)
print(input_freq)
```

```{r}
ggplot(input_freq, aes(x=Var1, y=Freq)) +
geom_bar(stat="identity", fill="#b83c31")  + 
labs(x ="Images per class", y="Number of classes", color="#26628E") + 
theme_hc(bgcolor = "darkunica") +
scale_colour_hc("darkunica") +
theme(title=element_text(size=18)) +
theme(axis.text = element_text(color = "white", size=12)) +
ggtitle("Class and Image Ratio of Original Images") +
theme(plot.title = element_text(hjust = 0.5)) +
annotate("text", size=4, color="white", x = 22, y = 1750, label = qq("Total Images: @{nrow(inputData)}\n Total Classes: @{nrow(distinct_classes)}")) +
expand_limits(x = 0)
```

```{r}
setwd("~/Projects/whale-tale")
inputData <- read.csv(file="input/train.csv", header=TRUE, sep=",")
augmentedData <- read.csv(file="augmented-correct-colors/train.csv", header=TRUE, sep=",")
combData_aug <- rbind(inputData, augmentedData)
input_counts <- combData_aug %>% plyr::count("Id")
input_freq_aug <- table(input_counts$freq)
input_freq_aug <- as.data.frame(input_freq_aug)
distinct_classes = combData_aug %>% distinct(Id)
print(input_freq_aug)
```


```{r}
ggplot(input_freq_aug, aes(x=Var1, y=Freq)) +
geom_bar(stat="identity", fill="#b83c31")  + 
labs(x ="Images per class", y="Number of classes", color="#26628E") + 
theme_wsj() +
theme(axis.title=element_text(size=14)) + 
ggtitle("Class and Image Ratio\nof Input and Augmented") +
theme(plot.title = element_text(hjust = 0.5)) +
annotate("text", x = 18, y = 3500, label = qq("Total Images: @{nrow(combData_aug)}\nTotal Classes: @{nrow(distinct_classes)}")) +
expand_limits(x = 0)
```



```{r}
setwd("~/Projects/whale-tale")
inputData <- read.csv(file="input/train.csv", header=TRUE, sep=",")

augmentedData <- read.csv(file="augmented-correct-colors/train.csv", header=TRUE, sep=",")
combData_all <- rbind(inputData, augmentedData)

augmentedData <- read.csv(file="augmented-correct-gray/train.csv", header=TRUE, sep=",")
combData_all <- rbind(combData_all, augmentedData)

augmentedData <- read.csv(file="augmented-correct-rotation/train.csv", header=TRUE, sep=",")
combData_all <- rbind(combData_all, augmentedData)

augmentedData <- read.csv(file="augmented-correct-shear/train.csv", header=TRUE, sep=",")
combData_all <- rbind(combData_all, augmentedData)

augmentedData <- read.csv(file="augmented-correct-zoom/train.csv", header=TRUE, sep=",")
combData_all <- rbind(combData_all, augmentedData)

input_counts <- combData_all %>% plyr::count("Id")
input_freq_all_sets <- table(input_counts$freq)
input_freq_all_sets <- as.data.frame(input_freq_all_sets)
distinct_classes = combData_all %>% distinct(Id)
print(input_freq_all_sets)
```

```{r}
ggplot(input_freq_all_sets, aes(x=Var1, y=Freq)) +
geom_bar(stat="identity", fill="#b83c31")  + 
labs(x ="Images per class", y="Number of classes", color="#26628E") + 
theme_wsj() +
theme(axis.title=element_text(size=14)) + 
ggtitle("Class and Image Ratio of\nInput and All Augmented") +
theme(plot.title = element_text(hjust = 0.5)) +
annotate("text", x = 21, y = 1750, label = qq("Total Images: @{nrow(combData_all)}\nTotal Classes: @{nrow(distinct_classes)}")) +
expand_limits(x = 0)
```


```{r}
setwd("~/Projects/whale-tale")
inputData <- read.csv(file="input/train.csv", header=TRUE, sep=",")
augmentedData <- read.csv(file="augmented-correct-large/train.csv", header=TRUE, sep=",")
combData_large <- rbind(inputData, augmentedData)
input_counts <- combData_large %>% plyr::count("Id")
input_freq_large <- table(input_counts$freq)
input_freq_large <- as.data.frame(input_freq_large)
distinct_classes = combData_large %>% distinct(Id)
print(input_freq_large)
```

```{r}
ggplot(input_freq_large, aes(x=Var1, y=Freq)) +
geom_bar(stat="identity", fill="#b83c31")  + 
labs(x ="Images per class", y="Number of classes", color="#26628E") + 
theme_wsj() +
theme(axis.title=element_text(size=14)) + 
ggtitle("Class and Image Ratio of\nInput and Largest Set") +
theme(plot.title = element_text(hjust = 0.5)) +
annotate("text", x = 10, y = 1750, label = qq("Total Images: @{nrow(combData_large)}\nTotal Classes: @{nrow(distinct_classes)}")) +
expand_limits(x = 0)
```

```{r results='asis'}

countsFrame <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("Training Set", "Total Images per Set", "Image Count in Least Represented Class")
colnames(countsFrame) <- x

de<-data.frame("Original Images", nrow(inputData), min(as.numeric(as.character(input_freq$Var1))))
colnames(de) <- x
countsFrame <- rbind(countsFrame, de)

de<-data.frame("Random Rotation", nrow(combData_aug), min(as.numeric(as.character(input_freq_aug$Var1))))
colnames(de) <- x
countsFrame <- rbind(countsFrame, de)

de<-data.frame("Random Shear", nrow(combData_aug), min(as.numeric(as.character(input_freq_aug$Var1))))
colnames(de) <- x
countsFrame <- rbind(countsFrame, de)

de<-data.frame("Random Zoom", nrow(combData_aug), min(as.numeric(as.character(input_freq_aug$Var1))))
colnames(de) <- x
countsFrame <- rbind(countsFrame, de)

de<-data.frame("Random Greyscale", nrow(combData_aug), min(as.numeric(as.character(input_freq_aug$Var1))))
colnames(de) <- x
countsFrame <- rbind(countsFrame, de)

de<-data.frame("Random Combination of All Techniques", nrow(combData_aug), min(as.numeric(as.character(input_freq_aug$Var1))))
colnames(de) <- x
countsFrame <- rbind(countsFrame, de)

de<-data.frame("Large Combination of All Techniques", nrow(combData_large), min(as.numeric(as.character(input_freq_large$Var1))))
colnames(de) <- x
countsFrame <- rbind(countsFrame, de)

kable(countsFrame)


```


```{r}
epochsFrame <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("Epoch Count", "Training Accuracy", "Kaggle MAP Score")
colnames(countsFrame) <- x

de<-data.frame(10, .0352, .32538)
colnames(de) <- x
epochsFrame <- rbind(epochsFrame, de)

de<-data.frame(20, .0888, .23156)
colnames(de) <- x
epochsFrame <- rbind(epochsFrame, de)

de<-data.frame(40, .606, .16363)
colnames(de) <- x
epochsFrame <- rbind(epochsFrame, de)

de<-data.frame(60, .672, .11876)
colnames(de) <- x
epochsFrame <- rbind(epochsFrame, de)

de<-data.frame(80, .796, NA)
colnames(de) <- x
epochsFrame <- rbind(epochsFrame, de)

epochsFrame.m <- melt(epochsFrame, id.vars='Epoch Count')

```

```{r}
epochsSmallFrame <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("Epoch Count", "Training Accuracy", "Kaggle MAP Score")
colnames(epochsSmallFrame) <- x

de<-data.frame(3, .035, .32846)
colnames(de) <- x
epochsSmallFrame <- rbind(epochsSmallFrame, de)

de<-data.frame(5, .0352, .32891)
colnames(de) <- x
epochsSmallFrame <- rbind(epochsSmallFrame, de)

de<-data.frame(6, .0352, .32827)
colnames(de) <- x
epochsSmallFrame <- rbind(epochsSmallFrame, de)

de<-data.frame(8, .0354, .32681)
colnames(de) <- x
epochsSmallFrame <- rbind(epochsSmallFrame, de)

epochsSmallFrame.m <- melt(epochsSmallFrame, id.vars='Epoch Count')


```

```{r}
ggplot(epochsFrame.m, aes(fill=variable, y=value, x=epochsFrame.m$`Epoch Count`)) + 
    geom_bar(position="dodge", stat="identity") +
    labs(x="Epoch Count", y="", title="Training Accuracy and MAP at Epic Counts") +
    theme_hc(bgcolor = "darkunica") +
    scale_colour_hc("darkunica") +
    theme(title=element_text(size=18)) +
    theme(axis.text = element_text(color = "white", size=12)) +
    theme(legend.position="right") +
    theme(legend.title=element_blank(), legend.direction = "vertical") +
    scale_x_continuous(breaks=c(10, 20, 40, 60, 80))
    

```



```{r}
ggplot(epochsSmallFrame.m, aes(fill=variable, y=value, x=epochsSmallFrame.m$`Epoch Count`)) + 
    geom_bar(position="dodge", stat="identity") +
    labs(x="Epoch Count", y="", title="Training Accuracy and MAP at Epic Counts") +
    theme_hc(bgcolor = "darkunica") +
    scale_colour_hc("darkunica") +
    theme(title=element_text(size=18)) +
    theme(axis.text = element_text(color = "white", size=12)) +
    theme(legend.position="right") +
    theme(legend.title=element_blank(), legend.direction = "vertical") +
    scale_x_continuous(breaks=c(3, 5, 6, 8))

```


```{r}
newWhaleFrame <- data.frame(matrix(ncol = 3, nrow = 0))
x <- c("Label Status", "Kaggle MAP Score")
colnames(newWhaleFrame) <- x

de<-data.frame("With Label", .32827)
colnames(de) <- x
newWhaleFrame <- rbind(newWhaleFrame, de)

de<-data.frame("Without Label", .07011)
colnames(de) <- x
newWhaleFrame <- rbind(newWhaleFrame, de)
```

```{r}
ggplot(newWhaleFrame, aes(x=newWhaleFrame$`Label Status`, y=newWhaleFrame$`Kaggle MAP Score`, fill=newWhaleFrame$`Label Status`)) + 
  geom_bar(stat="identity") +
  labs(x="new_whale Label Status", y="Kaggle MAP Score", title="Success With and Without new_whale Label") +
  theme_hc(bgcolor = "darkunica") +
  scale_colour_hc("darkunica") +
  theme(title=element_text(size=18)) +
  theme(axis.text = element_text(color = "white", size=12)) +
  theme(legend.position="none")


```


```{r}
trainingSetFrame <- data.frame(matrix(ncol = 2, nrow = 0))
x <- c("Training Set", "Kaggle MAP Score")
colnames(trainingSetFrame) <- x


de<-data.frame("Original Images", .32816)
colnames(de) <- x
trainingSetFrame <- rbind(trainingSetFrame, de)

de<-data.frame("Duplicate Images", .32770)
colnames(de) <- x
trainingSetFrame <- rbind(trainingSetFrame, de)

de<-data.frame("Shear", .32890)
colnames(de) <- x
trainingSetFrame <- rbind(trainingSetFrame, de)

de<-data.frame("Rotation", .32891)
colnames(de) <- x
trainingSetFrame <- rbind(trainingSetFrame, de)

de<-data.frame("Zoom", .32823)
colnames(de) <- x
trainingSetFrame <- rbind(trainingSetFrame, de)

de<-data.frame("Grayscale", .32824)
colnames(de) <- x
trainingSetFrame <- rbind(trainingSetFrame, de)

de<-data.frame("All Techniques", .32836)
colnames(de) <- x
trainingSetFrame <- rbind(trainingSetFrame, de)

de<-data.frame("Large", .24307)
colnames(de) <- x
trainingSetFrame <- rbind(trainingSetFrame, de)


```

```{r}
ggplot(trainingSetFrame, aes(x=trainingSetFrame$`Training Set`, y=trainingSetFrame$`Kaggle MAP Score`, fill=trainingSetFrame$`Training Set`)) + 
  geom_bar(stat="identity") +
  labs(x="Training Set", y="Kaggle MAP Score", title="Success with Augmented Sets") +
  theme_hc(bgcolor = "darkunica") +
  scale_colour_hc("darkunica") +
  theme(title=element_text(size=18)) +
  theme(axis.text = element_text(color = "white", size=12)) +
  theme(legend.position="none") +
  scale_y_continuous(limits=c(.24,.329),oob = rescale_none) +
  coord_flip() 
```

```{r}
misleadingTrainingSetFrame <- head(trainingSetFrame,-1)
ggplot(misleadingTrainingSetFrame, aes(x=misleadingTrainingSetFrame$`Training Set`, y=misleadingTrainingSetFrame$`Kaggle MAP Score`, fill=misleadingTrainingSetFrame$`Training Set`)) + 
  geom_bar(stat="identity") +
  labs(x="Training Set", y="Kaggle MAP Score", title="Success with Augmented Sets") +
  theme_hc(bgcolor = "darkunica") +
  scale_colour_hc("darkunica") +
  theme(title=element_text(size=18)) +
  theme(axis.text = element_text(color = "white", size=12)) +
  theme(legend.position="none") +
  scale_y_continuous(limits=c(.3275,.329),oob = rescale_none) +
  coord_flip() 
```